<!DOCTYPE html>
<html lang="zh">
  <head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>Behavior | Fireball Docs</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="http://docs.fireball-x.com/manual/scripting/attachable-script/index.html">
  <!-- Alternative links -->
  
    
      
    
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">
  <!-- CSS -->
  <!-- build:css build/css/navy.css -->

  
  <link rel="stylesheet" href="/css/anchor.css" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/tomorrow.min.css" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <!-- endbuild -->
  <!-- RSS -->
  <link rel="alternative" href="/atom.xml" title="Fireball Docs" type="application/atom+xml">
  <!-- Open Graph -->
  
    
    
  
  <!-- Swiftype -->
  
  <!-- Google Analytics -->
  
</head>


  
    <div id="full-wrap">
      <div class="container-fluid">
        <header>
    <nav class="navbar navbar-inverse">
        <div class="container navbar-wrapper">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">
                    <img alt="logo" src="/images/logo.png">
                </a>
            </div>
            <div id="navbar" class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    
                    <li ><a href="/">Home</a></li>
                    
                    <li ><a href="/manual/index">Manual</a></li>
                    
                    <li ><a href="/editor/index">Extending Editor</a></li>
                    
                    <li ><a href="/api">API</a></li>
                    
                    <li ><a href="http://fireball-x.com/en">Fireball</a></li>
                    
                    <li ><a href="http://docs-zh.fireball-x.com">中文</a></li>
                    
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="https://github.com/fireball-x/fireball/edit/dev/docs/fireball/scripting/attachable-script.md"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
                </ul>
            </div>

        </div>
    </nav>
</header>

      </div>
      <div class="container">
        <div class="container sidebar">
    <aside id="sidebar" role="navigation">
  <div class="inner">
      <ul class="nav nav-pills nav-stacked"><li role="presentation" class="sidebar-title"><strong class="sidebar-title">Get Started</strong></li><li role="presentation" ><a href="/manual/introduction" class="sidebar-link">What's Fireball</a></li><li role="presentation" ><a href="/manual/dashboard" class="sidebar-link">Dashboard</a></li><li role="presentation" ><a href="/manual/editor-overview" class="sidebar-link">Editor Overview</a></li><li role="presentation" class="sidebar-title"><strong class="sidebar-title">Scripting</strong></li><li role="presentation" ><a href="/manual/scripting/javascript-primer" class="sidebar-link">JavaScript Primer</a></li><li role="presentation" ><a href="/manual/scripting/nodes-in-scene" class="sidebar-link">Nodes in Scene</a></li><li role="presentation" class="active"><a href="/manual/scripting/attachable-script" class="sidebar-link">Behavior (Attachable Script)</a></li><li role="presentation" ><a href="/manual/scripting/access-script" class="sidebar-link">Script Accessibility</a></li><li role="presentation" ><a href="/manual/scripting/mixin-mechanic" class="sidebar-link">Mixin Mechanic</a></li><li role="presentation" ><a href="/manual/scripting/class" class="sidebar-link">Advanced FireClass</a></li><li role="presentation" ><a href="/manual/scripting/attributes" class="sidebar-link">Attributes</a></li><li role="presentation" ><a href="/manual/scripting/module" class="sidebar-link">Module</a></li><li role="presentation" ><a href="/manual/scripting/runtimes/cocos2d-js" class="sidebar-link">Cocos2d-js Scripting Guide</a></li><li role="presentation" class="sidebar-title"><strong class="sidebar-title">Navigation</strong></li><li role="presentation"><a role="button" href="#top">back to top</a></li><li role="presentation"><a role="button" href="https://github.com/fireball-x/docs-en/edit/master/source/_data/sidebar_manual.yml">edit sidebar</a></li></ul>
  </div>
</aside>
</div>
<div class="container content-wrap">
    <div class="row">
        <div class="col-lg-8 col-md-7 col-sm-9">
            <div class="title-header" id="top">
                <h1>Behavior</h1>
            </div>
            <div>
                <ol class="breadcrumb">
                    <li><a href="/">Home</a></li>
                    <li><a href="/manual/index">Manual</a></li>
                    <li class="active">Behavior</li>
                </ol>
            </div>
            <p>What’s the point of a scene editor if we can’t attach scripts to scene nodes and give them behaviors that we can combine and tweak in Inspector? Fireball’s great advantage is to allow you write script that can be attached to scene nodes, while you can still call any engine API from the script! Let’s work it out.</p>
<h2 id="Behavior_(Attachable_Script)">Behavior (Attachable Script)</h2><p>An attachable script must contain definition of a <code>Behavior</code>. The filename of the script is the class name. For example a script named <code>MyClass.js</code> creates a <code>Behavior</code> named <code>MyClass</code>.</p>
<p>(screenshot)</p>
<p>Once the script is attached to a node, the class name will be used for identifying this modular script in Inspector.</p>
<p>(screenshot)</p>
<p>The whole process is similar to how you write component script for an entity-component system but behind the scene they are quite different.</p>
<p>Behavior is one of the most usual <strong>FireClass</strong>. For details and advanced usage of FireClass, please refer to the <a href="/manual/scripting/class">FireClass</a>.</p>
<h3 id="Shared_Instance_of_Behavior">Shared Instance of Behavior</h3><p>Fireball use mixin to combine all scripts attached to a single node together. Thus for all of the scripts that attached to the same node, their instance (<code>this</code>) point to the same node.</p>
<p>Compare to other entity-component system, Fireball don’t have ‘component’ instance and ‘entity’ instance. There is only the node instance, with all properties and method available from scripts attached to the node.</p>
<p>To learn more about how script mixin works in Fireball, see <a href="mixin-mechanic.md">Mixin Mechanics</a>.</p>
<h2 id="Basic_Structure_of_an_Attachable_Script">Basic Structure of an Attachable Script</h2><p>Create a script file that follow this pattern:</p>
<pre><code class="js">var MyClass = Fire.Class({ // use Fire.Class to define your class
    extends: Fire.Behavior, // must have, every FireClass inherit from Fire.Behavior
    properties: {
        // properties that you want to serialize and exposed in Inspector
    },
    statics: {
        // you can export variables and functions declared outside of FireClass prototype object in this script
    },
    onLoad: {
        // initialization code
    }
});
</code></pre>
<p>The name <code>MyClass</code> in the script is not relevant, only the <strong>filename of the script</strong> is used for identifying this FireClass. Thus it’s not allowed to create scripts with the same name in a single project.</p>
<p>As long as your script contains a Behavior definition, it can be dragged and attached onto a node. Let’s keep going to see how to add property and function to your script.</p>
<h2 id="Add_Properties">Add Properties</h2><p>To allow values/variables in your script to be edited from the Inspector, you must add them as <code>properties</code> in your script.</p>
<pre><code class="js">var MyClass = Fire.Class({ // use Fire.Class to define your class
    extends: Fire.Behavior,
    properties: {
        myNumber: 0,
        myNode: {
            default: null,
            wrapper: cc.Node
        }
    }
});
</code></pre>
<p>In the above example, we defined two properties with different format.</p>
<ul>
<li>If your property is a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Primitive_values" target="_blank" rel="external">primitive value</a>, just write the default value that follows colon.</li>
<li>If your property is a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Objects" target="_blank" rel="external">object</a>, you need to explicitly define its default value and type. In the type field you can also write class defined with game engine API.</li>
</ul>
<p>Once this is done, your properties will be serialized and shown in Inspector. From here on you can edit them in Inspector, no need for changing the code if you just want value or reference to be updated.</p>
<p>In your script, you can access your properties with <code>this.myNumber</code>, <code>this.myNode</code>. For detailed script access information, read the next chapter <a href="">Access Scripts</a>.</p>
<h2 id="Add_Functions">Add Functions</h2><p>To add a function:</p>
<pre><code class="js">var MyClass = Fire.Class({ // use Fire.Class to define your class
    extends: Fire.Behavior,
    properties: {
        // some properties
    },
    myFunction: function() {
        Fire.log(&#39;hellow world!&#39;);
    }
});
</code></pre>
<p>Similar to properties, call a function in script with <code>this.myFunction()</code>.</p>
<h2 id="Initialization">Initialization</h2><p>If you want to declare variables that not exposed to Inspector, or run any initialization code when the class is created, put your code in <code>onLoad</code> function:</p>
<pre><code class="js">var MyClass = Fire.Class({ // use Fire.Class to define your class
    extends: Fire.Behavior,
    onLoad: function() {
        this.myVariable = 1;
    }
});
</code></pre>
<p>Event if <code>this.myVariable</code> is not shown in Inspector. It’s still accessible via other scripts. Again, more details can be found at <a href="access-script.md">Access Scripts</a>.</p>
<h2 id="Update">Update</h2><p><code>update</code> is another function that will be called by lifecycle control.</p>
<pre><code class="js">var MyClass = Fire.Class({ // use Fire.Class to define your class
    extends: Fire.Behavior,
    properties: {
        myCounter: 0
    }
    update: function() {
        this.myCounter++;
        Fire.log(this.myCounter);
    }
});
</code></pre>
<p><code>update</code> function will be called every frame by game engine. For different game engine the exact timing of <code>update</code> in program lifecycle may differ. Usually it’s before rendering happens for each frame.</p>
<p>The above example will increase <code>this.myCounter</code> by one each frame, and log the value to Fireball console view.</p>
<h2 id="Game_Engine_API">Game Engine API</h2><p>In your FireClass script, you can use any game engine API, including creating a class instance defined in a pure game engine script.</p>
<p>Let’s take Cocos2d-js engine API for example. If we’d like to set position for the current node. We have to rely on Cocos2d-js API:</p>
<pre><code class="js">var MyClass = Fire.Class({
    extends: Fire.Behavior,
    properties: {
        targetPosX: 0,
        targetPosY: 0
    }
    changePosition: function() {
        // call cc.Node.setPosition(x,y) to change node position
        this.setPosition(this.targetPosX, this.targetPosY);
    }
});
</code></pre>
<p>Don’t worry if you’re not Cocos2d-js user, the only thing that matters is you can use your favorite engine’s API in FireClass.</p>
<p>You can see exactly what you should do for writing script for a specific engine:</p>
<ul>
<li><a href="runtimes/cocos2d-js.md">Cocos2d-js</a></li>
<li>Pixi (coming soon)</li>
<li>Phaser (coming soon)</li>
</ul>

            <div>
                <hr>
                <a href="https://github.com/fireball-x/fireball/edit/dev/docs/fireball/scripting/attachable-script.md">Edit This Page</a>
            </div>
            <div id="discourse-comments"></div>
            <div class="footer">
                <footer id="footer" class="wrapper">
    <div id="footer-copyright">
      &copy; 2015 <a href="http://fireball-x.com/" target="_blank">Fireball Developers</a><br>
      Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>.
    </div>
    <div id="footer-links">
      <a href="https://twitter.com/" class="footer-link" target="_blank"><i class="fa fa-twitter"></i></a>
      <a href="https://github.com/" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>
    </div>
</footer>

            </div>
        </div>
        <div class="col-lg-1 col-md-2 hidden-sm hidden-xs">
            <aside id="article-toc" role="navigation" class="fixed">
                <div id="article-toc-inner">
                    <strong class="sidebar-title">TOC</strong>
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Behavior_(Attachable_Script)"><span class="toc-text">Behavior (Attachable Script)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Shared_Instance_of_Behavior"><span class="toc-text">Shared Instance of Behavior</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Basic_Structure_of_an_Attachable_Script"><span class="toc-text">Basic Structure of an Attachable Script</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Add_Properties"><span class="toc-text">Add Properties</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Add_Functions"><span class="toc-text">Add Functions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Initialization"><span class="toc-text">Initialization</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Update"><span class="toc-text">Update</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Game_Engine_API"><span class="toc-text">Game Engine API</span></a></li></ol>
                    <a href="#top" id="article-toc-top">back to top</a>
                </div>
            </aside>
        </div>
    </div>
</div>




  
  
    
    
      
      
        
        
        
        
        
        
        
        
        
        
        
        
      
      
      
      
        
        
        
      
      
    
    
    
  
  


      </div>
    </div>
    <!-- Scripts -->
<!-- build:js build/js/main.js -->
<!-- endbuild -->


<!-- Plugin search -->



<!--bootstrap -->
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/js/bootstrap.min.js" type="text/javascript"></script>

    <script src="/js/toc.js" type="text/javascript"></script>

<script src="/js/anchor.min.js" type="text/javascript"></script>
<script type="text/javascript">
  hljs.initHighlightingOnLoad();
  addAnchors('.content-wrap h1, .content-wrap h2, .content-wrap h3');
</script>
<!-- Swiftype -->

  
  
  
  

  

<!--discourse comment -->


    
    
    

    
        
        
        
    


  </body>
</html>
