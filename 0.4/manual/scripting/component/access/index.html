<!DOCTYPE html>
<html lang="zh">
  <head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>Component Access | Fireball Docs</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="http://docs.fireball-x.com/0.4/manual/scripting/component/access/index.html">
  <!-- Alternative links -->
  
    
      
    
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">
  <!-- CSS -->
  <!-- build:css build/css/navy.css -->

  
  <link rel="stylesheet" href="/css/anchor.css" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/tomorrow.min.css" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <!-- endbuild -->
  <!-- RSS -->
  <link rel="alternative" href="/atom.xml" title="Fireball Docs" type="application/atom+xml">
  <!-- Open Graph -->
  
    
    
  
  <!-- Swiftype -->
  
  <!-- Google Analytics -->
  
</head>


  
    <div id="full-wrap">
      <div class="container-fluid">
        <header>
    <nav class="navbar navbar-inverse">
        <div class="container navbar-wrapper">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">
                    <img alt="logo" src="/images/logo.png">
                </a>
            </div>
            <div id="navbar" class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    
                    <li ><a href="/">Home</a></li>
                    
                    <li ><a href="/manual/index">Manual</a></li>
                    
                    <li ><a href="/editor/index">Extending Editor</a></li>
                    
                    <li ><a href="/api">API</a></li>
                    
                    <li ><a href="http://fireball-x.com/en">Fireball</a></li>
                    
                    <li ><a href="http://docs-zh.fireball-x.com">中文</a></li>
                    
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="#"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
                </ul>
            </div>

        </div>
    </nav>
</header>

      </div>
      <div class="container">
        <div class="container sidebar">
    <aside id="sidebar" role="navigation">
  <div class="inner">
      <ul class="nav nav-pills nav-stacked"><li role="presentation" class="sidebar-title"><strong class="sidebar-title">Navigation</strong></li><li role="presentation"><a role="button" href="#top">back to top</a></li><li role="presentation"><a role="button" href="https://github.com/fireball-x/docs-en/edit/master/source/_data/sidebar_0.4.yml">edit sidebar</a></li></ul>
  </div>
</aside>
</div>
<div class="container content-wrap">
    <div class="row">
        <div class="col-lg-8 col-md-7 col-sm-9">
            <div class="title-header" id="top">
                <h1>Component Access</h1>
            </div>
            <div>
                <ol class="breadcrumb">
                    <li><a href="/">Home</a></li>
                    <li><a href="/"></a></li>
                    <li class="active">Component Access</li>
                </ol>
            </div>
            <h2 id="Controlling_By_Script">Controlling By Script</h2><p>Components can be modified in the Inspector Panel. Say, changing the <code>position</code> of <code>Transform</code> component will changes the attached entity’s position, and a different <code>Color</code> value of <code>SpriteRenderer</code> component determines in which color the entity is rendered. But such controlling can go further by script. The difference between two controlling methods is that script controlling is able to make a transition to the change, by modifying properties continuously during a time span. Scripts also response to players’ input, create or destroy Components and Entities, which implements all kinds of gameplay logic.<br>To make them happen, we’ll need to talk about how to access Entities and Components in a script.</p>
<h2 id="Accessing_Attached_Entity">Accessing Attached Entity</h2><p>Retrieving the Entity that a Component is attached to is a common action. All need to be done is to access the <code>this.entity</code> variable:</p>
<pre><code class="js">    start: function () {
        var myName = this.entity.name;
        Fire.log(&#39;starting&#39;, myName);
    }
</code></pre>
<h2 id="Accessing_Components">Accessing Components</h2><p>Accessing other Components attached to the same Entity is one of the easiest and most commly used action.</p>
<p>As mentioned in the previous chapter, a Component is merely an instance of the class. So step one, get the object reference. What you need is the Component interface <code>getComponent</code>, which returns the Component instance, attached to the Entity, of specified type. Usually this reference to instance is saved in a variable, which can be used for accessing any property in the Component.</p>
<pre><code class="js">    start: function () {
        var sr = this.getComponent(Fire.SpriteRenderer);

        // Change the color of the sprite&#39;s renderer
        sr.color = Fire.Color.red;
    }
</code></pre>
<p><code>Fire.SpriteRenderer</code> is a Fireball built-in Component. Alternatively, string-formed class name is also acceptable as the parameter:</p>
<pre><code class="js">    start: function () {
        var sr = this.getComponent(&quot;Fire.SpriteRenderer&quot;);

        // ...
    }
</code></pre>
<p>In fact, you can call the member function <code>getComponent</code> of any Entity object:</p>
<pre><code class="js">    start: function () {
        var transform = playerEntity.getComponent(Fire.Transform);

        // Rotate the transform around world position (10, 10)
        transform.rotateAround(Fire.v2(10, 10), 90);
    }
</code></pre>
<p><code>Transform</code>, the most common Component, is for controlling an Entity’s position, rotation and scaling in the scene. Both <code>Entity.transform</code> and <code>Component.transform</code> can get you the <code>Transform</code>. In our example above, code can be simpler:</p>
<pre><code class="js">    start: function () {
        playerEntity.transform.rotateAround(Fire.v2(10, 10), 90);
    }
</code></pre>
<p><code>getComponent</code> returns <code>null</code> if the specified Component doesn’t to an Entity. Accessing <code>null</code> will throw the <code>TypeError</code> exception in run-time.</p>
<h2 id="Accessing_Other_Objects">Accessing Other Objects</h2><p>Merely accessing Entities’ Components is usually not enough - scripts needs to do interops often. For instance, a cannon aiming the player character automatically requires continuing accessing the character’s position. That’s why Fireball has several ways to access other objects.</p>
<h3 id="Setting_By_Inspector">Setting By Inspector</h3><p>The easiest way is to set objects needed in advance in the Inspector Panel. It only needs an Entity typed property declared in script.</p>
<pre><code class="js">// Cannon.js

var Comp = Fire.Class({
    extends: Fire.Component,
    properties: {
        // 声明一个 player 属性，类型为 Entity
        player: {
            default: null,
            type: Fire.Entity
        }
    }
});
</code></pre>
<p>The code declares a <code>player</code> property in <code>properties</code>, having <code>null</code> as the default value, and specifies the object type as <code>Fire.Entity</code>. Consider it as the statement <code>public Fire.Entity player = null;</code> in other languages. This property look like this in the Inspector Panel:</p>
<p><img src="/manual/scripting/component/access/player-in-inspector-null.png" alt="player-in-inspector-null"></p>
<p>Then you can drag any Entity from the Hierarchy Panel to the Inspector Panel, to set it as the <code>player</code> property of the editing Component instance.</p>
<p><img src="/manual/scripting/component/access/player-in-inspector.png" alt="player-in-inspector"></p>
<p><code>player</code> can be accessed directly as:</p>
<pre><code class="js">var Comp = Fire.Class({
    extends: Fire.Component,
    properties: {
        player: {
            default: null,
            type: Fire.Entity
        }
    },
    start: function () {
        // 显示 player 的名字
        Fire.log(this.player.name);
    }
});
</code></pre>
<p>Here is an exciting feature: if you declare a property as a Component type, and drag an Entity into the Inspector Panel, the Component of the specified type in that Entity, instead of the Entity itself, will be assigned to the target property.</p>
<pre><code class="js">var Comp = Fire.Class({
    extends: Fire.Component,
    properties: {
        targetTransform: {
            default: null,
            type: Fire.Transform
        }
    },
});
</code></pre>
<p>It is the most convenient way to connect objects by properties. You can even set the property’s default value to <code>[]</code>, an empty array, instead of <code>null</code>. Array makes it possible to assign multiple objects in the Inspector Panel.</p>
<p>However drag &amp; drop would be not good enough if accessing objects needs to be done in run-time. That’s why you’ll need the find object function described below.</p>
<h3 id="Finding_Child_Objects">Finding Child Objects</h3><p>Sometimes, multiple game objects of a same category, such as turrets, enemies and FXs, exist in the scene, and are managed altogether by a global script. Dragging and dropping every one of them into the Inspector Panel would be dull and stupid. A better practice is to gather them as child objects of a single parent, and accessing them via the parent.</p>
<pre><code class="js">// CannonManager.js
var Comp = Fire.Class({
    extends: Fire.Component,

    constructor: function () {
        this.cannons = [];
    },

    properties: {
        targetTransform: {
            default: null,
            type: Fire.Transform
        }
    },

    start: function () {
        this.cannons = this.entity.getChildren();
    }
});
</code></pre>
<p><code>getChildren</code> is an Entity’s member function to get an array containing all child Entities.<br>It is possible to get a particular child by name as well, by calling an Entity’s <code>find</code> function.</p>
<pre><code class="js">this.entity.find(&#39;Main Cannon&#39;);
</code></pre>
<h3 id="Global_Finding_By_Name">Global Finding By Name</h3><p>The static function <code>Fire.Entity.find</code> allows you to find a particular Entity in the whole scene.</p>
<pre><code class="js">// CannonManager.js
var Comp = Fire.Class({
    extends: Fire.Component,

    constructor: function () {
        this.player = null;
    },

    start: function () {
        this.player = Fire.Entity.find(&#39;/Main Player&#39;);
    }
});
</code></pre>
<p>Please note:</p>
<ul>
<li><code>find</code> can be an instance function or a static one. Instance function version is for finding a child object, while static function looks for the object globally, i.e. from the root of the scene and traverse all children until a value can be returned.</li>
<li>The find path should not start with <code>/</code> when looking for child objects, while it is essential to have <code>/</code> when doing global finding.</li>
</ul>

            <div>
                <hr>
                <a href="#">Edit This Page</a>
            </div>
            <div id="discourse-comments"></div>
            <div class="footer">
                <footer id="footer" class="wrapper">
    <div id="footer-copyright">
      &copy; 2015 <a href="http://fireball-x.com/" target="_blank">Fireball Developers</a><br>
      Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>.
    </div>
    <div id="footer-links">
      <a href="https://twitter.com/" class="footer-link" target="_blank"><i class="fa fa-twitter"></i></a>
      <a href="https://github.com/" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>
    </div>
</footer>

            </div>
        </div>
        <div class="col-lg-1 col-md-2 hidden-sm hidden-xs">
            <aside id="article-toc" role="navigation" class="fixed">
                <div id="article-toc-inner">
                    <strong class="sidebar-title">TOC</strong>
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Controlling_By_Script"><span class="toc-text">Controlling By Script</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Accessing_Attached_Entity"><span class="toc-text">Accessing Attached Entity</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Accessing_Components"><span class="toc-text">Accessing Components</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Accessing_Other_Objects"><span class="toc-text">Accessing Other Objects</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Setting_By_Inspector"><span class="toc-text">Setting By Inspector</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Finding_Child_Objects"><span class="toc-text">Finding Child Objects</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Global_Finding_By_Name"><span class="toc-text">Global Finding By Name</span></a></li></ol></li></ol>
                    <a href="#top" id="article-toc-top">back to top</a>
                </div>
            </aside>
        </div>
    </div>
</div>




  
  
    
    
      
      
        
        
        
        
        
        
        
        
        
        
        
        
      
      
      
      
        
        
        
      
      
    
    
    
  
  


      </div>
    </div>
    <!-- Scripts -->
<!-- build:js build/js/main.js -->
<!-- endbuild -->


<!-- Plugin search -->



<!--bootstrap -->
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/js/bootstrap.min.js" type="text/javascript"></script>

    <script src="/js/toc.js" type="text/javascript"></script>

<script src="/js/anchor.min.js" type="text/javascript"></script>
<script type="text/javascript">
  hljs.initHighlightingOnLoad();
  addAnchors('.content-wrap h1, .content-wrap h2, .content-wrap h3');
</script>
<!-- Swiftype -->

  
  
  
  

  

<!--discourse comment -->


    
    
    

    
        
        
        
    


  </body>
</html>
